function sendYandexGoal(a){yaCounter37696905.reachGoal(a),ga("send","pageview","/"+a+".html")}function myValidateForm(a){a.find(".req");a.find(".req").removeClass("error");var e=!0;return a.find(".req").each(function(r,n){var t=$(n);if(""==t.val()&&($(n).addClass("error"),e=!1),"checkbox"==t.attr("type")&&0==t.prop("checked")&&($(n).addClass("error"),e=!1),"EMAIL"===t.attr("name")&&""===t.val()||"EMAIL"!==t.attr("name")||isValidEmailAddress(t.val())||($(n).addClass("error"),e=!1),"PASSWORD"===t.attr("name")){var i=!1;""===t.val()||t.val().length<6&&(i=!0),i&&($(n).addClass("error"),e=!1)}if("CONFIRM_PASSWORD"===t.attr("name")){var d=!1,s=a.find(".req[name=PASSWORD]");""===t.val()||t.val()!==s.val()&&(d=!0),d&&($(n).addClass("error"),e=!1)}}),e}function SendAjax(a,e,r){r=r||function(){},$.ajax({url:"/ajax.php",dataType:"json",type:"POST",data:{action:a,data:e},error:function(a){console.log(a)}}).done(function(a){r(a)})}function isValidEmailAddress(a){var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return e.test(a)}$.fn.serializeObject=function(){var a=this,e={},r={},n={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(a,e,r){return a[e]=r,a},this.push_counter=function(a){return void 0===r[a]&&(r[a]=0),r[a]++},$.each($(this).serializeArray(),function(){if(n.validate.test(this.name)){for(var r,t=this.name.match(n.key),i=this.value,d=this.name;void 0!==(r=t.pop());)d=d.replace(new RegExp("\\["+r+"\\]$"),""),r.match(n.push)?i=a.build([],a.push_counter(d),i):r.match(n.fixed)?i=a.build([],r,i):r.match(n.named)&&(i=a.build({},r,i));e=$.extend(!0,e,i)}}),e};
$(document).ready(function(){$(".js-slider-main").slick({dots:!0,infinite:!0,speed:300,slidesToShow:1,arrows:!1,fade:!0}),$(".js-scrollbar").mCustomScrollbar(),$("[name=PHONE]").mask("+7(999)-999-99-99"),$("body").on("submit",".js-form-submit",function(t){t.preventDefault();var i=$(this);if(!myValidateForm(i))return!1;var s=i.serializeObject();SendAjax("SEND_FORM",s,function(t){i.html(t.html)})}),$("body").on("blur",".js-form-submit input",function(){var t=$(this).closest(".js-form-submit");if(!myValidateForm(t))return!1})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZ1bmN0aW9ucy5qcyIsInNjcmlwdHMuanMiXSwibmFtZXMiOlsic2VuZFlhbmRleEdvYWwiLCJfdGFyZ2V0IiwieWFDb3VudGVyMzc2OTY5MDUiLCJyZWFjaEdvYWwiLCJnYSIsIm15VmFsaWRhdGVGb3JtIiwiZm9ybSIsImZpbmQiLCJyZW1vdmVDbGFzcyIsIl92YWxpZCIsImVhY2giLCJpbmRleCIsImVsIiwiX2lucHV0IiwiJCIsInZhbCIsImFkZENsYXNzIiwiYXR0ciIsInByb3AiLCJpc1ZhbGlkRW1haWxBZGRyZXNzIiwiX2hhc19wYXNzd29yZF9lcnJvciIsImxlbmd0aCIsIl9oYXNfcGFzc3dvcmRfY29uZmlybV9lcnJvciIsIl9wYXNzd29yZCIsIlNlbmRBamF4IiwiX2FjdGlvbiIsIl9kYXRhIiwiX2NhbGxCYWNrIiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwidHlwZSIsImRhdGEiLCJhY3Rpb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJkb25lIiwiZW1haWxBZGRyZXNzIiwicGF0dGVybiIsIlJlZ0V4cCIsInRlc3QiLCJmbiIsInNlcmlhbGl6ZU9iamVjdCIsInNlbGYiLCJ0aGlzIiwianNvbiIsInB1c2hfY291bnRlcnMiLCJwYXR0ZXJucyIsInZhbGlkYXRlIiwia2V5IiwicHVzaCIsImZpeGVkIiwibmFtZWQiLCJidWlsZCIsImJhc2UiLCJ2YWx1ZSIsInB1c2hfY291bnRlciIsInVuZGVmaW5lZCIsInNlcmlhbGl6ZUFycmF5IiwibmFtZSIsImsiLCJrZXlzIiwibWF0Y2giLCJtZXJnZSIsInJldmVyc2Vfa2V5IiwicG9wIiwicmVwbGFjZSIsImV4dGVuZCIsImRvY3VtZW50IiwicmVhZHkiLCJzbGljayIsImRvdHMiLCJpbmZpbml0ZSIsInNwZWVkIiwic2xpZGVzVG9TaG93IiwiYXJyb3dzIiwiZmFkZSIsIm1DdXN0b21TY3JvbGxiYXIiLCJtYXNrIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJfZm9ybSIsImh0bWwi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QUFHRyxHQUdsQ2xCLEdBQU9oQyxFQUFFc0QsUUFBTyxFQUFNdEIsRUFBTWtCLE1BRXpCbEI7QUMzSFhoQyxFQUFFdUQsVUFBVUMsTUFBTSxXQUNkeEQsRUFBRSxtQkFBbUJ5RCxPQUNqQkMsTUFBTSxFQUNOQyxVQUFVLEVBQ1ZDLE1BQU8sSUFDUEMsYUFBYyxFQUNkQyxRQUFRLEVBQ1JDLE1BQU0sSUFFVi9ELEVBQUUsaUJBQWlCZ0UsbUJBQ25CaEUsRUFBRSxnQkFBZ0JpRSxLQUFLLHFCQUV2QmpFLEVBQUUsUUFBUWtFLEdBQUcsU0FBVSxrQkFBbUIsU0FBVUMsR0FDaERBLEVBQUVDLGdCQUNGLElBQUlDLEdBQVFyRSxFQUFFK0IsS0FDZCxLQUFLeEMsZUFBZThFLEdBQ2hCLE9BQU8sQ0FFWCxJQUFJekQsR0FBUXlELEVBQU14QyxpQkFDbEJuQixVQUFTLFlBQWFFLEVBQU8sU0FBVU0sR0FDbkNtRCxFQUFNQyxLQUFLcEQsRUFBS29ELFVBSXhCdEUsRUFBRSxRQUFRa0UsR0FBRyxPQUFRLHdCQUF5QixXQUMxQyxHQUFJRyxHQUFRckUsRUFBRStCLE1BQU13QyxRQUFRLGtCQUM1QixLQUFLaEYsZUFBZThFLEdBQ2hCLE9BQU8iLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHNlbmRZYW5kZXhHb2FsKF90YXJnZXQpIHtcclxuICAgIHlhQ291bnRlcjM3Njk2OTA1LnJlYWNoR29hbChfdGFyZ2V0KTtcclxuICAgIGdhKCdzZW5kJywgJ3BhZ2V2aWV3JywgJy8nICsgX3RhcmdldCArICcuaHRtbCcpO1xyXG59XHJcbmZ1bmN0aW9uIG15VmFsaWRhdGVGb3JtKGZvcm0pIHtcclxuICAgIHZhciBfaXRlbXMgPSBmb3JtLmZpbmQoXCIucmVxXCIpO1xyXG4gICAgZm9ybS5maW5kKFwiLnJlcVwiKS5yZW1vdmVDbGFzcyhcImVycm9yXCIpO1xyXG4gICAgdmFyIF92YWxpZCA9IHRydWU7XHJcbiAgICBmb3JtLmZpbmQoJy5yZXEnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWwpIHsgLyrQv9GA0L7QstC10YDQutCwINC30LDQv9C+0LvQvdC10L3QuNGPKi9cclxuICAgICAgICB2YXIgX2lucHV0ID0gJChlbCk7XHJcbiAgICAgICAgaWYgKF9pbnB1dC52YWwoKSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICQoZWwpLmFkZENsYXNzKCdlcnJvcicpO1xyXG4gICAgICAgICAgICBfdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9pbnB1dC5hdHRyKFwidHlwZVwiKSA9PSBcImNoZWNrYm94XCIgJiYgX2lucHV0LnByb3AoXCJjaGVja2VkXCIpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICQoZWwpLmFkZENsYXNzKCdlcnJvcicpO1xyXG4gICAgICAgICAgICBfdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9pbnB1dC5hdHRyKFwibmFtZVwiKSA9PT0gXCJFTUFJTFwiICYmIF9pbnB1dC52YWwoKSA9PT0gXCJcIikge1xyXG4gICAgICAgIH0gZWxzZSBpZiAoX2lucHV0LmF0dHIoXCJuYW1lXCIpID09PSBcIkVNQUlMXCIgJiYgIWlzVmFsaWRFbWFpbEFkZHJlc3MoX2lucHV0LnZhbCgpKSkge1xyXG4gICAgICAgICAgICAkKGVsKS5hZGRDbGFzcygnZXJyb3InKTtcclxuICAgICAgICAgICAgX3ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfaW5wdXQuYXR0cihcIm5hbWVcIikgPT09IFwiUEFTU1dPUkRcIikge1xyXG4gICAgICAgICAgICB2YXIgX2hhc19wYXNzd29yZF9lcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoX2lucHV0LnZhbCgpID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2lucHV0LnZhbCgpLmxlbmd0aCA8IDYpIHtcclxuICAgICAgICAgICAgICAgIF9oYXNfcGFzc3dvcmRfZXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfaGFzX3Bhc3N3b3JkX2Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVsKS5hZGRDbGFzcygnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgIF92YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfaW5wdXQuYXR0cihcIm5hbWVcIikgPT09IFwiQ09ORklSTV9QQVNTV09SRFwiKSB7XHJcbiAgICAgICAgICAgIHZhciBfaGFzX3Bhc3N3b3JkX2NvbmZpcm1fZXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIF9wYXNzd29yZCA9IGZvcm0uZmluZChcIi5yZXFbbmFtZT1QQVNTV09SRF1cIik7XHJcbiAgICAgICAgICAgIGlmIChfaW5wdXQudmFsKCkgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChfaW5wdXQudmFsKCkgIT09IF9wYXNzd29yZC52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgX2hhc19wYXNzd29yZF9jb25maXJtX2Vycm9yID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoX2hhc19wYXNzd29yZF9jb25maXJtX2Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAkKGVsKS5hZGRDbGFzcygnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgIF92YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gX3ZhbGlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBTZW5kQWpheChfYWN0aW9uLCBfZGF0YSwgX2NhbGxCYWNrKSB7XHJcbiAgICBfY2FsbEJhY2sgPSBfY2FsbEJhY2sgfHwgZnVuY3Rpb24gKCkge1xyXG4gICAgfTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsOiAnL2FqYXgucGhwJyxcclxuICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgIHR5cGU6ICdQT1NUJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICdhY3Rpb24nOiBfYWN0aW9uLFxyXG4gICAgICAgICAgICAnZGF0YSc6IF9kYXRhXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBfY2FsbEJhY2soZGF0YSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZEVtYWlsQWRkcmVzcyhlbWFpbEFkZHJlc3MpIHtcclxuICAgIHZhciBwYXR0ZXJuID0gbmV3IFJlZ0V4cCgvXigoXCJbXFx3LVxcc10rXCIpfChbXFx3LV0rKD86XFwuW1xcdy1dKykqKXwoXCJbXFx3LVxcc10rXCIpKFtcXHctXSsoPzpcXC5bXFx3LV0rKSopKShAKCg/OltcXHctXStcXC4pKlxcd1tcXHctXXswLDY2fSlcXC4oW2Etel17Miw2fSg/OlxcLlthLXpdezJ9KT8pJCl8KEBcXFs/KCgyNVswLTVdXFwufDJbMC00XVswLTldXFwufDFbMC05XXsyfVxcLnxbMC05XXsxLDJ9XFwuKSkoKDI1WzAtNV18MlswLTRdWzAtOV18MVswLTldezJ9fFswLTldezEsMn0pXFwuKXsyfSgyNVswLTVdfDJbMC00XVswLTldfDFbMC05XXsyfXxbMC05XXsxLDJ9KVxcXT8kKS9pKTtcclxuICAgIHJldHVybiBwYXR0ZXJuLnRlc3QoZW1haWxBZGRyZXNzKTtcclxufVxyXG5cclxuXHJcbiQuZm4uc2VyaWFsaXplT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgICAgICBqc29uID0ge30sXHJcbiAgICAgICAgICAgIHB1c2hfY291bnRlcnMgPSB7fSxcclxuICAgICAgICAgICAgcGF0dGVybnMgPSB7XHJcbiAgICAgICAgICAgICAgICBcInZhbGlkYXRlXCI6IC9eW2EtekEtWl1bYS16QS1aMC05X10qKD86XFxbKD86XFxkKnxbYS16QS1aMC05X10rKVxcXSkqJC8sXHJcbiAgICAgICAgICAgICAgICBcImtleVwiOiAvW2EtekEtWjAtOV9dK3woPz1cXFtcXF0pL2csXHJcbiAgICAgICAgICAgICAgICBcInB1c2hcIjogL14kLyxcclxuICAgICAgICAgICAgICAgIFwiZml4ZWRcIjogL15cXGQrJC8sXHJcbiAgICAgICAgICAgICAgICBcIm5hbWVkXCI6IC9eW2EtekEtWjAtOV9dKyQvXHJcbiAgICAgICAgICAgIH07XHJcbiAgICB0aGlzLmJ1aWxkID0gZnVuY3Rpb24gKGJhc2UsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICBiYXNlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICByZXR1cm4gYmFzZTtcclxuICAgIH07XHJcbiAgICB0aGlzLnB1c2hfY291bnRlciA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBpZiAocHVzaF9jb3VudGVyc1trZXldID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcHVzaF9jb3VudGVyc1trZXldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHB1c2hfY291bnRlcnNba2V5XSsrO1xyXG4gICAgfTtcclxuICAgICQuZWFjaCgkKHRoaXMpLnNlcmlhbGl6ZUFycmF5KCksIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBza2lwIGludmFsaWQga2V5c1xyXG4gICAgICAgIGlmICghcGF0dGVybnMudmFsaWRhdGUudGVzdCh0aGlzLm5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGssXHJcbiAgICAgICAgICAgICAgICBrZXlzID0gdGhpcy5uYW1lLm1hdGNoKHBhdHRlcm5zLmtleSksXHJcbiAgICAgICAgICAgICAgICBtZXJnZSA9IHRoaXMudmFsdWUsXHJcbiAgICAgICAgICAgICAgICByZXZlcnNlX2tleSA9IHRoaXMubmFtZTtcclxuICAgICAgICB3aGlsZSAoKGsgPSBrZXlzLnBvcCgpKSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIC8vIGFkanVzdCByZXZlcnNlX2tleVxyXG4gICAgICAgICAgICByZXZlcnNlX2tleSA9IHJldmVyc2Vfa2V5LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcXFxbXCIgKyBrICsgXCJcXFxcXSRcIiksICcnKTtcclxuICAgICAgICAgICAgLy8gcHVzaFxyXG4gICAgICAgICAgICBpZiAoay5tYXRjaChwYXR0ZXJucy5wdXNoKSkge1xyXG4gICAgICAgICAgICAgICAgbWVyZ2UgPSBzZWxmLmJ1aWxkKFtdLCBzZWxmLnB1c2hfY291bnRlcihyZXZlcnNlX2tleSksIG1lcmdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBmaXhlZFxyXG4gICAgICAgICAgICBlbHNlIGlmIChrLm1hdGNoKHBhdHRlcm5zLmZpeGVkKSkge1xyXG4gICAgICAgICAgICAgICAgbWVyZ2UgPSBzZWxmLmJ1aWxkKFtdLCBrLCBtZXJnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gbmFtZWRcclxuICAgICAgICAgICAgZWxzZSBpZiAoay5tYXRjaChwYXR0ZXJucy5uYW1lZCkpIHtcclxuICAgICAgICAgICAgICAgIG1lcmdlID0gc2VsZi5idWlsZCh7fSwgaywgbWVyZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGpzb24gPSAkLmV4dGVuZCh0cnVlLCBqc29uLCBtZXJnZSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBqc29uO1xyXG59OyIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICQoJy5qcy1zbGlkZXItbWFpbicpLnNsaWNrKHtcclxuICAgICAgICBkb3RzOiB0cnVlLFxyXG4gICAgICAgIGluZmluaXRlOiB0cnVlLFxyXG4gICAgICAgIHNwZWVkOiAzMDAsXHJcbiAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgICAgIGFycm93czogZmFsc2UsXHJcbiAgICAgICAgZmFkZTogdHJ1ZSxcclxuICAgIH0pO1xyXG4gICAgJChcIi5qcy1zY3JvbGxiYXJcIikubUN1c3RvbVNjcm9sbGJhcigpO1xyXG4gICAgJCgnW25hbWU9UEhPTkVdJykubWFzayhcIis3KDk5OSktOTk5LTk5LTk5XCIpO1xyXG5cclxuICAgICQoXCJib2R5XCIpLm9uKFwic3VibWl0XCIsIFwiLmpzLWZvcm0tc3VibWl0XCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciBfZm9ybSA9ICQodGhpcyk7XHJcbiAgICAgICAgaWYgKCFteVZhbGlkYXRlRm9ybShfZm9ybSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX2RhdGEgPSBfZm9ybS5zZXJpYWxpemVPYmplY3QoKTtcclxuICAgICAgICBTZW5kQWpheChcIlNFTkRfRk9STVwiLCBfZGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgX2Zvcm0uaHRtbChkYXRhLmh0bWwpO1xyXG4vLyAgICAgICAgICAgIHNlbmRZYW5kZXhHb2FsKGRhdGFbXCJHT0FMXCJdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgJChcImJvZHlcIikub24oXCJibHVyXCIsIFwiLmpzLWZvcm0tc3VibWl0IGlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2Zvcm0gPSAkKHRoaXMpLmNsb3Nlc3QoXCIuanMtZm9ybS1zdWJtaXRcIik7XHJcbiAgICAgICAgaWYgKCFteVZhbGlkYXRlRm9ybShfZm9ybSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
